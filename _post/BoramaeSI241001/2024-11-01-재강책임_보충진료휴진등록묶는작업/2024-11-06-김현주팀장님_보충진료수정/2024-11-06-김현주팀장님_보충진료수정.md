




## 11월 12일까지 

보충진료등록 -> 

시간까지 조회해달라 / 테이블 화면 보기가 쉽지 않다.



## 11월 14일 추가

- 통계 쿼리
```sql

SELECT * FROM(
    SELECT
         ''      AS DEPT_NM
        ,''      AS STF_NM
        ,''      AS APY_STR_DTM
        ,''      AS APY_END_DTM
        ,''      AS DTM_SUM
     FROM DUAL
    UNION
    
    SELECT /*+ HIS.PA.AC.PE.SC.SelectDoctorPlusWork_Statistics */
    --    case grouping (APY_STR_DTM)
    --        when 0 then '0'
    --        when 1 then '1'
    --        when 2 then '2'
    --        else '44'
    --    end          as ss
    
        CASE WHEN GROUPING (MED_DEPT_CD||'['||FC_GET_DEPT_NM(MED_DEPT_CD)||']')=0
             THEN CASE WHEN GROUPING (DR_STF_NO)= 0
                       THEN CASE WHEN GROUPING (APY_STR_DTM)=0
                                 THEN CASE WHEN GROUPING (APY_END_DTM) =0
                                           THEN MED_DEPT_CD||'['||FC_GET_DEPT_NM(MED_DEPT_CD)||']'
                                           ELSE NULL
                                      END
             							      ELSE MED_DEPT_CD||'['||FC_GET_DEPT_NM(MED_DEPT_CD)||']'
                            END
                       ELSE NULL
                  END
             ELSE NULL
         END                                AS DEPT_NM                     /* 2.진료과 */
       ,CASE WHEN GROUPING (DR_STF_NO)=0
             THEN CASE WHEN GROUPING (APY_STR_DTM)= 0
                       THEN CASE WHEN GROUPING (APY_END_DTM)=0
                                 THEN DR_STF_NO
            								     ELSE  NULL
            								 END
            					 ELSE DR_STF_NO
            			 END
             ELSE NULL
        END                                 AS STF_NM                     /* 3.진료의사 */
        ,CASE WHEN GROUPING (DR_STF_NO)=0
              THEN CASE WHEN GROUPING (APY_END_DTM)=0
                        THEN TO_CHAR(APY_STR_DTM,'YYYY-MM-DD AM HH12:MI')
        					      ELSE NULL
                    END
              ELSE NULL
          END
                                        AS APY_STR_DTM                /* 4.보충진료시작일시 */



        ,CASE WHEN GROUPING (DR_STF_NO) =0
              THEN CASE GROUPING (APY_STR_DTM)
                        WHEN 0 THEN TO_CHAR(APY_END_DTM,'YYYY-MM-DD AM HH12:MI')
        								ELSE '합계'
        					  END
              ELSE NULL
          END                           AS APY_END_DTM                /* 5.보충진료종료일시 */
    
    
        ,  CASE WHEN GROUPING(DR_STF_NO) = 0
                     THEN CASE WHEN GROUPING (DR_STF_NO)= 0
                               THEN CASE WHEN GROUPING (APY_STR_DTM)=0
                                         THEN CASE WHEN GROUPING (APY_END_DTM)=0
                                                   THEN TO_CHAR(MAX(SPLM_MED_TM))
          								                         ELSE  NULL
          								                     END
          								                ELSE TO_CHAR(SUM(SPLM_MED_TM))
          								           END
          								      ELSE NULL
          								 END
                WHEN GROUPING(MED_DEPT_CD||'['||FC_GET_DEPT_NM(MED_DEPT_CD)||']')=1
                THEN  NULL

            END     AS DTM_SUM                                         /* 6.총보충시간 */
    
     FROM ACDPCSPD        /* 의사보충일정정보 테이블 */
          ACDPCTMD        /* 의사휴진시간정보 테이블 */
    WHERE (APY_STR_DTM BETWEEN TO_DATE(:IN_FROM_DT ,'YYYYMM')
                           AND last_day(TO_DATE(:IN_TO_DT ,'YYYYMM')) + .99999)
      and CNCL_DT is null
    
    group by rollup(  MED_DEPT_CD||'['||FC_GET_DEPT_NM(MED_DEPT_CD)||']'
                     ,DR_STF_NO
                     ,APY_STR_DTM
                     ,APY_END_DTM
                    )
    
    
    )
ORDER BY
      stf_nm
    , apy_str_dtm asc
```