


# 제목 : 2021년 이전 환자 서명 이미지 조회방법 문의의 건
## 받는사람
- '김선화' <qnaudchlrkd@ezcaretech.com>,
- '김성준(보라매병원팀)'<sungjunkim@ezcaretech.com>,
## 참조
- '박수현' <shpark@ezcaretech.com>,
- '신동명' <shindm1016@ezcaretech.com>,
- '김형준' <m-hjkim@ezcaretech.com>,
- '성현석' <gustjr3454@ezcaretech.com>,
- '김재강' <rlaworkd91@ezcaretech.com>,
- '김용록' <ygreen0516@ezcaretech.com>,
## 내용
```
안녕하세요, 차세대개발팀 김태훈 책임입니다.

원무과 사용자 데이터 검증 과정에서 과거에 개인정보 동의 서명을 했던 환자의 서명 이미지가 보이지 않는다는 문의를 받았습니다.

이와 관련해서 내용을 확인하다보니, 차세대 프로그램에 연동되어 있는 NICE 멀티리더기로 받은 서명은 문제가 없으나 그 이전의 서명 이미지를 보여주는 방식의 확인이 필요하여 문의드립니다. 

각 제조사에 따라 ASIS에서 서명 string 데이터를 저장하고, 기서명된 이미지를 조회하는 방식은 제가 알기로 이렇습니다. 

- NICE: 서명 데이터 앞에 'NIC'를 붙여서 저장 / 서명 이미지 조회 시 StringData를 NICEVCAT.OCX를 사용하여 변환

- KSNet: 서명 데이터 앞에 'KS'를 붙여서 저장 / 서명 이미지 조회 시 StringData를 KSNet_Dongle을 사용하여 변환

- FirstData, KICC: 각 VAN사 모듈에서 변환된 string을 그대로 저장 / 서명 이미지 조회 시 서버에서 이미지 경로를 가져와서 표현

제가 알고 있는 환자 서명 이미지 변환방식이 맞는지, 그리고 과거 2021년 NICE 사용 이전 환자 서명 이미지를 조회하는 방법을 문의드립니다 .

확인 부탁드립니다. 

감사합니다. 

- 김태훈 올림.

==============================================================

김태훈 책임 / 보라매차세대SI팀   

주소 : (07071) 서울특별시 동작구 보라매로5길 51 5층 510호

Mobile : 010-3282-8507

E-mail : dametime@ezcaretech.com

==============================================================
```

### 내용 분석
<h4 style="color : red">원무과 사용자 데이터 검증 과정에서 과거에 개인정보 동의 서명을 했던 환자의 서명 이미지가 보이지 않는다는 문의</h4>

이와 관련해서 내용을 확인하다보니,

-> 차세대 프로그램에 연동되어 있는 **NICE 멀티리더기로 받은 서명은 문제가 없으나 그 이전의 서명 이미지를 보여주는 방식의 확인이 필요**하여 문의드립니다. 

각 제조사에 따라 ASIS에서 서명 string 데이터를 저장하고, 기서명된 이미지를 조회하는 방식은 제가 알기로 이렇습니다. 

- NICE:
    ```
    서명 데이터 앞에 'NIC'를 붙여서 저장 -> 서명 이미지 조회 -> StringData를 NICEVCAT.OCX를 사용하여 변환
    ```
- KSNet: 
    ```
    서명 데이터 앞에 'KS'를 붙여서 저장 -> 서명 이미지 조회 -> StringData를 KSNet_Dongle을 사용하여 변환
    ```
- FirstData, KICC: 
    ```
    각 VAN사 모듈에서 변환된 string을 그대로 저장 -> 서명 이미지 조회 -> 서버에서 이미지 경로를 가져와 -> 표현
    ```
제가 알고 있는 환자 서명 이미지 변환방식이 맞는지, 그리고 과거 2021년 NICE 사용 이전 환자 서명 이미지를 조회하는 방법을 문의드립니다 .

확인 부탁드립니다. 


### 결론
전자서명 이미지 조회하는 방법에 대한 문의


## 1. 회신 제목 : [RE]보라매차세대SI_머니플러스 전문 연동 개발 관련 NVCAT 설정 방법 문의의 건


▶대용량첨부파일 | 다운로드기간 : 2024/06/12 ~ 2024/06/18
- 보라매병원 가상계좌.zip
- VACS_v.1.1_20210817.zip


안녕하십니까.
NICE정보통신 방현우입니다.

격무로 바쁘신 와중에도 서울특별시보라매병원 관련 개발에 신경써주셔서 감사드립니다.

병원 외부에서 접속 시 병원 전용선 환경을 이용할 수 없어 별도로 외부 접속이 가능한 IP/PORT 정보 송부드립니다.

하기 네트워크 정보로 개발계 테스트 진행 부탁드리며 추가적으로 확인 필요한 사항 말씀주시면 확인 후 회신드리겠습니다.


[IP/PORT 정보]

- 구분 : 개발계
- 출발지 : ANY
- 목적지(NICE) : 
    - IP : 211.33.136.19
    - PORT : 7846

수표조회의 경우 **NVCAT.DLL** 전문 내에 포함되어 있어 **별도의 프로그램 없이 NVCAT만으로 연동이 가능**합니다.


<h4 style="color : red">다만, 현재 EMR에서 별도로 수표조회를 구현해 놓은 것으로 알고 있어 연동 방식을 어떻게 구현하실지에 따라 연동 방법이 달라질 것으로 보입니다. </h4>

말씀주신 수표조회 외에 가상계좌의 경우 현재 연동하고 계신 NVCAT가 아닌 별도의 모듈을 통해 서비스 제공되고 있어

가상계좌 관련 모듈 및 자료 첨부드리오니 참고 부탁드립니다.

추가적으로 궁금하신 사항이나 필요하신 부분 말씀해주시면 답변드리도록 하겠습니다.

감사합니다.

방현우 드림.

## 2. 회신 제목 : Re:[RE]보라매차세대SI_머니플러스 전문 연동 개발 관련 NVCAT 설정 방법 문의의 건

안녕하세요 매니저님,

이지케어텍 김태훈 책임입니다.

유선 상으로 말씀드린대로, 일전에 알려주신 **머니플러스 사용환경에서 하이패스 토큰 등록 시 에러코드 -28이 발생**하는 경우가 있어 

NVCAT 환경설정 파일 및 거래 로그 파일을 첨부하였습니다. 
확인 부탁드립니다. 

감사합니다.

- [로그.txt](/보라매SI_원무보험/240711_전자서명_김태훈책임이메일/20240711_NICE%20전용망%20접속%20설정%20변경%20후%20하이패스%20등록%20전문%20처리%20결과.md)


![첨부사진](/보라매SI_원무보험/240711_전자서명_김태훈책임이메일/20240711_NVCAT%20환경설정%20변경3.png)


## 3. 회신 제목 : Re:Re:[RE]보라매차세대SI_머니플러스 전문 연동 개발 관련 추가 문의의 건
안녕하세요 매니저님,

이지케어텍 김태훈입니다.

유선 상으로 NICE에서 제공해주신 IP/PORT 정보(211.33.136.19:7846)가 인터넷 결제설정을 해야 되는 정보라고 하셔서 NVCAT 설정을 첨부된 사진과 같이 변경 후 

다시 한 번 하이패스 등록을 진행해보았습니다.

그 결과 **NVCAT 호출은 정상적으로 진행**되었으나,
**하이패스 등록 결과 전문 데이터 인코딩이 깨진 상태로 데이터가 넘어와서 추가적인 확인이 필요**할 것 같습니다. 

이와 관련된 C:\NICEVCAT\log 폴더 안에 있는 로그 파일을 추출하여 첨부하였습니다. 

바쁘신 가운데 신경써주셔서 감사합니다. 
확인 부탁드립니다. 
- 김태훈 올림

### 결론
보내준 네트워크 정보로 연결은 됐으나 인코딩이 깨져 추가적인 확인이 필요하다.